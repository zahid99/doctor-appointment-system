!function(a){function n(){a(window).on("load",function(){o()}),a(window).on("redraw",function(){switched=!1,o()}),a(window).on("resize",o)}function o(){h.draw(),i.draw(),j.draw(),k.draw()}function p(a){return Math.PI/180*a-Math.PI/180*90}function q(){c={total:Math.floor((b.end-b.start)/86400),days:Math.floor((b.end-b.now)/86400),hours:24-Math.floor((b.end-b.now)%86400/3600),minutes:60-Math.floor((b.end-b.now)%86400%3600/60),seconds:60-Math.floor((b.end-b.now)%86400%3600%60)}}function r(){var l=a("#"+b.selectors.canvas_seconds).width(),m=new Kinetic.Stage({container:b.selectors.canvas_seconds,width:l,height:l});d=new Kinetic.Shape({drawFunc:function(d){var e=a("#"+b.selectors.canvas_seconds).width(),f=e/2-b.seconds.borderWidth/2,g=e/2,h=e/2;d.beginPath(),d.arc(g,h,f,p(0),p(6*c.seconds)),d.fillStrokeShape(this),a(b.selectors.value_seconds).html(60-c.seconds)},stroke:b.seconds.borderColor,strokeWidth:b.seconds.borderWidth}),h=new Kinetic.Layer,h.add(d),m.add(h);var n=a("#"+b.selectors.canvas_minutes).width(),o=new Kinetic.Stage({container:b.selectors.canvas_minutes,width:n,height:n});e=new Kinetic.Shape({drawFunc:function(d){var e=a("#"+b.selectors.canvas_minutes).width(),f=e/2-b.minutes.borderWidth/2,g=e/2,h=e/2;d.beginPath(),d.arc(g,h,f,p(0),p(6*c.minutes)),d.fillStrokeShape(this),a(b.selectors.value_minutes).html(60-c.minutes)},stroke:b.minutes.borderColor,strokeWidth:b.minutes.borderWidth}),i=new Kinetic.Layer,i.add(e),o.add(i);var q=a("#"+b.selectors.canvas_hours).width(),r=new Kinetic.Stage({container:b.selectors.canvas_hours,width:q,height:q});f=new Kinetic.Shape({drawFunc:function(d){var e=a("#"+b.selectors.canvas_hours).width(),f=e/2-b.hours.borderWidth/2,g=e/2,h=e/2;d.beginPath(),d.arc(g,h,f,p(0),p(360*c.hours/24)),d.fillStrokeShape(this),a(b.selectors.value_hours).html(24-c.hours)},stroke:b.hours.borderColor,strokeWidth:b.hours.borderWidth}),j=new Kinetic.Layer,j.add(f),r.add(j);var s=a("#"+b.selectors.canvas_days).width(),t=new Kinetic.Stage({container:b.selectors.canvas_days,width:s,height:s});g=new Kinetic.Shape({drawFunc:function(d){var e=a("#"+b.selectors.canvas_days).width(),f=e/2-b.days.borderWidth/2,g=e/2,h=e/2;d.beginPath(),0==c.total?d.arc(g,h,f,p(0),p(360)):d.arc(g,h,f,p(0),p(360/c.total*(c.total-c.days))),d.fillStrokeShape(this),a(b.selectors.value_days).html(c.days)},stroke:b.days.borderColor,strokeWidth:b.days.borderWidth}),k=new Kinetic.Layer,k.add(g),t.add(k)}function s(){var a=setInterval(function(){if(c.seconds>59){if(60-c.minutes==0&&24-c.hours==0&&0==c.days)return clearInterval(a),void(void 0!==m&&m.call(this));c.seconds=1,c.minutes>59?(c.minutes=1,i.draw(),c.hours>23?(c.hours=1,c.days>0&&(c.days--,k.draw())):c.hours++,j.draw()):c.minutes++,i.draw()}else c.seconds++;h.draw()},1e3)}var b,c,d,e,f,g,h,i,j,k,l,m;a.fn.final_countdown=function(c,d){if(l=a(this),l.is(":visible")){var e=a.extend({start:void 0,end:void 0,now:void 0,selectors:{value_seconds:".clock-seconds .val",canvas_seconds:"canvas-seconds",value_minutes:".clock-minutes .val",canvas_minutes:"canvas-minutes",value_hours:".clock-hours .val",canvas_hours:"canvas-hours",value_days:".clock-days .val",canvas_days:"canvas-days"},seconds:{borderColor:"#7995D5",borderWidth:"6"},minutes:{borderColor:"#ACC742",borderWidth:"6"},hours:{borderColor:"#ECEFCB",borderWidth:"6"},days:{borderColor:"#FF9900",borderWidth:"6"}},c);b=a.extend({},e,c),void 0===b.start&&(b.start=l.data("start")),void 0===b.end&&(b.end=l.data("end")),void 0===b.now&&(b.now=l.data("now")),l.data("border-color")&&(b.seconds.borderColor=b.minutes.borderColor=b.hours.borderColor=b.days.borderColor=l.data("border-color")),b.now<b.start&&(b.start=b.now,b.end=b.now),b.now>b.end&&(b.start=b.now,b.end=b.now),"function"==typeof d&&(m=d),n(),q(),r(),s()}}}(jQuery);